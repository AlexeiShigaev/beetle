# задачка про жука на координатной плоскости

_На бесконечной координатной сетке находится жук. Жук может перемещаться на 1 клетку вверх (x,y+1), вниз (x,y-1), влево (x-1,y), вправо (x+1,y), по одной клетке за шаг.<br>
Клетки, в которых сумма цифр в координате X плюс сумма цифр в координате Y больше чем 25 недоступны жуку. Например, клетка с координатами (59, 79) недоступна, т.к. 5+9+7+9=30, что больше 25.<br>
Сколько клеток может посетить жук, если его начальная позиция (1000,1000), (включая начальную клетку)._


## Размышления:
В задаче есть несколько неопределенностей:
* Клетка с координатой (10001001, 20003001) тоже удовлетворяет условию. В контексте уточнения "на бесконечной координатной плоскости", задача начинает играть совсем другими красками :)
* С другой стороны, описан вполне себе понятный способ движения жука - на клетку вверх/вниз/влево/вправо, и если сумма больше 25, то туда ходить нельзя. (А если обойти с другой стороны?!)
Из этого немедленно следует, что, в третью четверть, равно как и во вторую и в четвертую, наш Жук просто не попадет. Не перешагнет через 999.
* Вот эта фраза "... больше чем 25 недоступны жуку", значит ли это что условие будет "пока X + Y <= 25", или...


## Реализации

Первый и второй вариант демонстрируют неверное и решение и результат.

1. (for_statement.py) Решаем в лоб (до уточнения задачи). Берем от координаты (1000, 1000)
квадрат в правой верхней четверти плоскости, 1000х1000 клеток.<br>
Два вложенных цикла, обходим квадрат по строкам и столбцам.<br>
В подсчет будут включены не смежные зоны, недоступные, если жук будет ходить только по правилу смежности.
И да. Самый долгий и безобразный способ. И ответ не верный.
    ```
    Правый верхний квадрат содержит 313488 клеток удовлетворяющих нашему условию
    Время выполнения: 3.7812161445617676
    если применить @lru_cache(1024)
    Время выполнения: 0.6690385341644287
    ```
2. (contiguous.py) Второй вариант рекурсии. Исследуем правую верхнюю четверть, 
проходя по столбцам снизу вверх до тех пор, пока не встретим недоступную клетку.
Острое ощущение, что часть клеток таким способом не посчитаем. (раздел про математику ниже)
    ```
    Правый верхний квадрат содержит 43050 клеток удовлетворяющих нашему условию
    Время выполнения: 0.19401121139526367
    если применить @lru_cache(1024)
    Время выполнения: 0.049002647399902344
    ```
3. (contiguous1.py) Рекурсивный метод, с обходом вверх и направо, фиксируем в матрице проверенные клетки для исключения дальнейших повторных проверок.<br>
Результат верный.
    ```
    Правый верхний квадрат содержит 148848 клеток удовлетворяющих нашему условию
    Время выполнения: 1.206068992614746
    если применить @lru_cache(1024)
    Время выполнения: 0.6570374965667725
    ```
4. (processes.py) Попытка вытащить в отдельные процессы вычисления. Быстрее чем вариант 3 не получается.
    ```
    Правый верхний квадрат содержит 148848 клеток удовлетворяющих нашему условию
    Время выполнения: 6.906068992614746
    если применить @lru_cache(1024)
    Время выполнения: 6.30108118057251
    ```

## Важный момент
Задача содержит подсчет суммы цифр чисел. 
Это перевод в строку, потом только подсчет, причем эти подсчеты во-многом однотипные и повторяющиеся (одно и то же считаем)<br>
Типовой вариант задач CPU-bound. Распараллеливать или строить нитки - не сильно много толку. 
За-то можно применить кеширование вычислений. И, таки да! Результат ускорения - от двух до шести раз.

В связи с этим, если задача будет, все таки, считать все несмежные к движению клетки, во всех четвертях от клетки (1000, 1000),<br>
имеет смысл вычислять только значения от 0 до 999 и кешировать их, при этом, левая нижняя четверть должна считаться в сравнении 25, 
а правая верхняя в сравнении с 23, поскольку две единицы в разряде тысяч отбрасываем. 
А левая верхняя и правая нижняя четверти проверяются на условие до 24, по той же причине.

## Немного математики и допуски
1. Отбрасываем тысячные порядки, из соображений описанных выше. 
К тому же, надо бы не повторяться с клетками которые уже посчитали, фиксировать их, заодно, кешировать, 
а, главное, матрица для фиксации будет всего лишь 1000х1000.
Таким образом можно масштабировать подсчеты плоскости с координатами вплоть до 10 тыс.
Использовать для фиксации другие структуры данных можно, но скорость работы резко падает.
2. Как уже сказано выше (казус 999), работаем только с первой четвертью (верхняя правая).
3. Берем столбец X=0 и идем вверх, пока сумма цифр координат не превышает 23 (не 25, см. п.1). 
Не буду долго утомлять почему, но идем мы до 698. Число клеток, соответственно, 699. Дальше ходить нельзя.
4. X=1, идем до 598; X + Y = 23. НО!!! следующая клетка за 599 это 560, и туда можно попасть из столбца X=0, и, спорю, не только туда.
5. Продолжаем до X=698.
6. Из п.4 следует, что обходить клетку во все четыре стороны нет смысла. Достаточно двигаясь вверх, заглядывать направо.

